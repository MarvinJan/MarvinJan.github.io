var _createClass=function(){function s(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}}();function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Cubify=function(){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{interactive:!1};_classCallCheck(this,i),this.front=e,this.faces=t.faces||{},this.width=t.width||this.getDefaultWidth(),this.parent=this.front.parentNode,this.bgColor=this.getBackgroundColor(),this.commonStyle={width:this.width+"px",height:this.width+"px"},this.sceneStyle={perspective:4*this.width+"px"},this.faceStyle={position:"absolute",top:0,left:0},this.cubeStyle={transform:"translateZ(-"+this.width/2+"px)","transform-style":"preserve-3d"},this.interactive=t.interactive,this.renderCube(),t.interactive&&(this.angleX=0,this.angleY=0,this.setUpListeners())}return _createClass(i,[{key:"getBackgroundColor",value:function(){return window.getComputedStyle(this.front,null).getPropertyValue("background-color")}},{key:"getDefaultWidth",value:function(){var t=[],e=function(e){e&&t.push(e.offsetWidth,e.offsetHeight)};return e(this.front),e(this.faces.back),e(this.faces.right),e(this.faces.top),e(this.faces.bottom),e(this.faces.left),Math.max.apply(Math,t)}},{key:"generateDOM",value:function(e,t,i){var s=i||document.createElement("div");if(s.classList.add(t),"string"==typeof e)return this.setStyle(s,e),s;var n=Object.assign({},this.commonStyle,e),a=Object.keys(n).map(function(e){return e+": "+n[e]+";"}).join(" ");return this.setStyle(s,a),s}},{key:"setFaceStyle",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"X",i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return e.style.transform="rotate"+t+"("+i+"deg) translateZ("+this.width/2+"px)"}},{key:"setStyle",value:function(e,t){return e.setAttribute("style",t)}},{key:"composeCube",value:function(){var e=this.generateDOM(this.sceneStyle,"cubify__scene"),t=this.generateDOM(this.cubeStyle,"cubify__cube"),i=this.generateDOM(this.faceStyle,"cubify__face",this.front),s=this.faces.back?this.generateDOM(this.faceStyle,"cubify__face",this.faces.back):this.generateDOM(this.faceStyle,"cubify__face"),n=this.faces.top?this.generateDOM(this.faceStyle,"cubify__face",this.faces.top):this.generateDOM(this.faceStyle,"cubify__face"),a=this.faces.bottom?this.generateDOM(this.faceStyle,"cubify__face",this.faces.bottom):this.generateDOM(this.faceStyle,"cubify__face"),r=this.faces.right?this.generateDOM(this.faceStyle,"cubify__face",this.faces.right):this.generateDOM(this.faceStyle,"cubify__face"),c=this.faces.left?this.generateDOM(this.faceStyle,"cubify__face",this.faces.left):this.generateDOM(this.faceStyle,"cubify__face");return this.setFaceStyle(i,"Y",0),this.setFaceStyle(s,"Y",180),this.setFaceStyle(n,"X",90),this.setFaceStyle(a,"X",-90),this.setFaceStyle(r,"Y",90),this.setFaceStyle(c,"Y",-90),t.append(i,s,n,a,c,r),e.append(t),this.cube=t,e}},{key:"renderCube",value:function(){this.parent.append(this.composeCube())}},{key:"rotateCube",value:function(e,t,i){var s=void 0,n=void 0;console.log(),n="touchmove"===e.type?(s=t-e.touches[0].clientX,i-e.touches[0].clientY):(s=t-e.clientX,i-e.clientY);var a=this.angleX-s/2,r=this.angleY+n/2;return this.cube.style.transform="translateZ(-"+this.width/2+"px) rotateY("+a+"deg) rotateX("+r+"deg)",[a,r]}},{key:"setAngles",value:function(e,t){this.angleX=e,this.angleY=t}},{key:"setUpListeners",value:function(){var a=this;this.cube.addEventListener("touchstart",function(e){e.preventDefault();var t=e.touches[0].clientX,i=e.touches[0].clientY,s=void 0,n=function(e){return e.preventDefault(),s=a.rotateCube(e,t,i),a.rotateCube(e,t,i)};document.addEventListener("touchmove",n,{passive:!1}),document.addEventListener("touchend",function e(){s&&a.setAngles.apply(a,_toConsumableArray(s)),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",e)})},{passive:!1}),this.cube.addEventListener("mousedown",function(e){e.preventDefault();var t=e.clientX,i=e.clientY,s=void 0,n=function(e){return e.preventDefault(),s=a.rotateCube(e,t,i),a.rotateCube(e,t,i)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",function e(){s&&a.setAngles.apply(a,_toConsumableArray(s)),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",e)})})}}]),i}();